SFFv2 Header

+--------+------------------------------+------+
| Offset | Description                  | Size |
+--------+------------------------------+------+
|  +$00  | ElecbyteSpr signature        |  12  |
+--------+------------------------------+------+
|  +$0C  | VersionLo3                   |   1  |
+--------+------------------------------+------+
|  +$0D  | VersionLo2                   |   1  |
+--------+------------------------------+------+
|  +$0E  | VersionLo1                   |   1  |
+--------+------------------------------+------+
|  +$0F  | VersionHi                    |   1  |
+--------+------------------------------+------+
|  +$10  | ??? set to 0                 |  10  |
+--------+------------------------------+------+
|  +$1A  | Palette map offset           |   4  |
+--------+------------------------------+------+
|  +$1E  | ??? set to 0                 |   6  |
+--------+------------------------------+------+
|  +$24  | SpriteList offset            |   4  |
+--------+------------------------------+------+
|  +$28  | Number of sprites            |   4  |
+--------+------------------------------+------+
|  +$2C  | ??? set to 0x200             |   4  |
+--------+------------------------------+------+
|  +$30  | Number of palettes           |   4  |
+--------+------------------------------+------+
|  +$34  | Palette bank offset          |   4  |
+--------+------------------------------+------+
|  +$38  | OnDemand DataSize            |   4  | <- Palettes + SpritesData(OnDemand)
+--------+------------------------------+------+
|  +$3C  | OnDemand DataSize Total      |   4  | <- Header + PaletteMap + SpriteList + OnDemand DataSize
+--------+------------------------------+------+
|  +$40  | OnLoad DataSize              |   4  | <- SpritesData(OnLoad)
+--------+------------------------------+------+
|  +$44  | unused???                    | 444  |
+--------+------------------------------+------+



SpriteList Node Header

+--------+-----------------------+------+
| Offset | Description           | Size |
+--------+-----------------------+------+
|  +$00  | Sprite group          |   2  |
+--------+-----------------------+------+
|  +$02  | Sprite number         |   2  |
+--------+-----------------------+------+
|  +$04  | Sprite image width    |   2  |
+--------+-----------------------+------+
|  +$06  | Sprite image height   |   2  |
+--------+-----------------------+------+
|  +$08  | Sprite image Xaxis    |   2  |
+--------+-----------------------+------+
|  +$0A  | Sprite image Yaxis    |   2  |
+--------+-----------------------+------+
|  +$0C  | Sprite linked index   |   2  |
+--------+-----------------------+------+
|  +$0E  | Compression method    |   1  |
+--------+-----------------------+------+
|  +$0F  | Color depth           |   1  |
+--------+-----------------------+------+
|  +$10  | Offset to data*,**    |   4  |  see notes
+--------+-----------------------+------+
|  +$14  | Data length**         |   4  |  see notes
+--------+-----------------------+------+
|  +$18  | Palette number        |   2  |
+--------+-----------------------+------+
|  +$1A  | Load Mode             |   2  |
+--------+-----------------------+------+
 
Palette map:
+--------+-----------------------+------+
| Offset | Description           | Size |
+--------+-----------------------+------+
|  +$00  | Palette group         |   2  |
+--------+-----------------------+------+
|  +$02  | Palette number        |   2  |
+--------+-----------------------+------+
|  +$04  | Total of colors       |   4  |
+--------+-----------------------+------+
|  +$08  | Offset to data*       |   4  |  see notes
+--------+-----------------------+------+
|  +$0C  | Palette length        |   4  |
+--------+-----------------------+------+
 
NOTES:
-------
 *   To calcule effective file address:
     OnDemand:  (PaletteBank Offset + Offset to data)
     OnLoad:    (SpriteData Section Start Offset + Offset to data)

 **  Linked sprites has length 0, but the offset is
     the same of his parent;
 
Load Modes:
 OnDemand(default) - 0x00 (sprite.decompressonload=0)
 OnLoad            - 0x01 (sprite.decompressonload=1)

Compression Method:
 NONE  - 0x00
 ???   - 0x01
 RLE8  - 0x02
 RLE5  - 0x03
 LZ5   - 0x04

 
SFFv2 file structure:
------------------------------------

 +---------------------------------+
 | SFFv2 Header                    |
 +---------------------------------+
 | Palette Map, linear             |
 | 16bytes per map                 |
 +---------------------------------+
 | Sprite List, linear             |
 | 28bytes per node                |
 +---------------------------------+ PaletteBank Section
 | Palette bank, linear            |
 | size is 4*colors of current pal |
 +---------------------------------+ SpriteData Section
 | Sprite data OnLoad, linear      |
 +---------------------------------+
 | Sprite data OnDemand, linear    |
 +---------------------------------+